<!DOCTYPE html>
<html lang="en" class="{{ 'bg-gray-900 text-gray-100' if dark_mode else 'bg-gray-100 text-gray-900' }}">
<head>
    <meta charset="UTF-8" />
    <title>Chemical Reaction Balancer & Visualizer  </title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
</head>
<body class="min-h-screen flex flex-col items-center justify-start p-6 space-y-10">
    <header class="w-full max-w-md flex justify-between items-center mb-4">
        <h1 class="{{ 'text-blue-400' if dark_mode else 'text-blue-600' }} text-4xl font-bold mt-6">
            Chemical Reaction Balancer & Visualizer 
        </h1>
        <!-- Dark mode toggle button -->
        <form method="POST" style="margin-top: 1.5rem;">
            <button name="toggle_dark_mode" type="submit" 
                class="p-2 rounded focus:outline-none hover:bg-gray-300 dark:hover:bg-gray-700"
                aria-label="Toggle Dark Mode">
                <!-- Moon SVG icon -->
                {% if dark_mode %}
                <!-- Sun icon for light mode -->
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                    d="M12 3v1m0 16v1m8.66-9h-1m-15 0h-1m13.66 6.66l-.7-.7m-10.62-10.62l-.7-.7m12.02 12.02l-.7-.7m-10.62-10.62l-.7-.7M12 7a5 5 0 100 10 5 5 0 000-10z" />
                </svg>
                {% else %}
                <!-- Moon icon for dark mode -->
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-700" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                    d="M21 12.79A9 9 0 1111.21 3a7 7 0 009.79 9.79z" />
                </svg>
                {% endif %}
            </button>
        </form>
    </header>

    <!-- Reaction Balancer Form -->
    <section class="{{ 'bg-gray-800' if dark_mode else 'bg-white' }} p-6 rounded shadow-md w-full max-w-md">
        <h2 class="{{ 'text-gray-300' if dark_mode else 'text-gray-700' }} text-2xl font-semibold mb-4">
            Reaction Balancer
        </h2>
        <form method="POST" class="space-y-4">
            <input type="hidden" name="balance_submit" value="1" />
            <label for="reaction_formula" class="block font-medium {{ 'text-gray-300' if dark_mode else 'text-gray-700' }}">
                Enter reaction (e.g. H2 + O2 -> H2O):
            </label>
            <input type="text" name="reaction_formula" id="reaction_formula" required
                   class="w-full px-3 py-2 border rounded
                          {{ 'bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400' if dark_mode else 'bg-white border-gray-300' }}"
                   placeholder="H2 + O2 -> H2O" />
            <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white py-2 rounded font-semibold">
                Balance Reaction
            </button>
        </form>
        {% if balance_msg %}
            <p class="mt-4 text-center {{ 'text-green-400' if dark_mode else 'text-green-700' }}">{{ balance_msg }}</p>
        {% endif %}
        {% if balanced_equation %}
            <div class="{{ 'bg-yellow-700 text-yellow-200' if dark_mode else 'bg-yellow-100 text-yellow-900' }} mt-4 p-3 rounded text-center font-mono">
                {{ balanced_equation }}
            </div>
        {% endif %}
    </section>

    <!-- Molecule Visualizer Form -->
    <section class="{{ 'bg-gray-800' if dark_mode else 'bg-white' }} p-6 rounded shadow-md w-full max-w-md">
        <h2 class="{{ 'text-gray-300' if dark_mode else 'text-gray-700' }} text-2xl font-semibold mb-4">
            Molecule Visualizer (SMILES)
        </h2>
        <form method="POST" class="space-y-4">
            <input type="hidden" name="visualize_submit" value="1" />
            <label for="smiles_input" class="block font-medium {{ 'text-gray-300' if dark_mode else 'text-gray-700' }}">
                Enter SMILES strings separated by + (e.g. CCO + O=O):
            </label>
            <input type="text" name="smiles_input" id="smiles_input" required
                   class="w-full px-3 py-2 border rounded
                          {{ 'bg-gray-700 border-gray-600 text-gray-200 placeholder-gray-400' if dark_mode else 'bg-white border-gray-300' }}"
                   placeholder="CCO + O=O" />
            <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded font-semibold">
                Visualize Molecules
            </button>
        </form>
        {% if visualize_msg %}
            <p class="mt-4 text-center {{ 'text-blue-400' if dark_mode else 'text-blue-700' }}">{{ visualize_msg }}</p>
        {% endif %}
        {% if img_data %}
            <div class="mt-4 flex justify-center">
                <img src="data:image/png;base64,{{ img_data }}" alt="Molecule Visualization" class="shadow rounded" />
            </div>
        {% endif %}
    </section>
</body>
</html>
